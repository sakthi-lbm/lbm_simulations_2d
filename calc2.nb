(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13312,        374]
NotebookOptionsPosition[     11982,        347]
NotebookOutlinePosition[     12373,        364]
CellTagsIndexPosition[     12330,        361]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Properties", " ", "of", " ", "D2Q9", " ", "lattice", " ", "stencils"}], 
   "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"w", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"4", "/", "9"}], ",", " ", 
       RowBox[{"1", "/", "9"}], ",", " ", 
       RowBox[{"1", "/", "9"}], ",", " ", 
       RowBox[{"1", "/", "9"}], ",", " ", 
       RowBox[{"1", "/", "9"}], ",", " ", 
       RowBox[{"1", "/", "36"}], ",", " ", 
       RowBox[{"1", "/", "36"}], ",", " ", 
       RowBox[{"1", "/", "36"}], ",", " ", 
       RowBox[{"1", "/", "36"}]}], "}"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{"cx", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "1", ",", " ", "0", ",", " ", 
       RowBox[{"-", "1"}], ",", " ", "0", ",", " ", "1", ",", " ", 
       RowBox[{"-", "1"}], ",", " ", 
       RowBox[{"-", "1"}], ",", " ", "1"}], "}"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"cy", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{"0", ",", " ", "0", ",", " ", "1", ",", " ", "0", ",", " ", 
       RowBox[{"-", "1"}], ",", " ", "1", ",", " ", "1", ",", " ", 
       RowBox[{"-", "1"}], ",", " ", 
       RowBox[{"-", "1"}]}], "}"}]}], ";"}], "\n", "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Hxx", "[", "i_", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"cx", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "^", "2"}], " ", "-", " ", 
      RowBox[{"1", "/", "3"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Hyy", "[", "i_", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"cy", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "^", "2"}], " ", "-", " ", 
      RowBox[{"1", "/", "3"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Hxy", "[", "i_", "]"}], " ", ":=", " ", 
     RowBox[{
      RowBox[{"cx", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "*", 
      RowBox[{"cy", "[", 
       RowBox[{"[", "i", "]"}], "]"}]}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", 
    RowBox[{"distribution", " ", "functions"}], "*)"}], "\n", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "i_", "]"}], " ", ":=", " ", 
      RowBox[{"\[Rho]", "*", 
       RowBox[{"w", "[", 
        RowBox[{"[", "i", "]"}], "]"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", " ", "+", " ", 
         RowBox[{"3", "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ux", "*", 
             RowBox[{"cx", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}], " ", "+", " ", 
            RowBox[{"uy", "*", 
             RowBox[{"cy", "[", 
              RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}]}], " ", "+", " ", 
         RowBox[{"9", "*", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"mxx", "*", 
              RowBox[{"Hxx", "[", "i", "]"}]}], " ", "+", " ", 
             RowBox[{"myy", "*", 
              RowBox[{"Hyy", "[", "i", "]"}]}], " ", "+", " ", 
             RowBox[{"2", "*", "mxy", "*", 
              RowBox[{"Hxy", "[", "i", "]"}]}]}], ")"}], "/", "2"}]}]}], 
        ")"}]}]}], ";"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"f", "[", "i_", "]"}], " ", ":=", " ", 
     RowBox[{"\[Rho]", "*", 
      RowBox[{"w", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"1", " ", "+", " ", 
        RowBox[{"FMi", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ux", "*", 
            RowBox[{"cx", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{"uy", "*", 
            RowBox[{"cy", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}]}], " ", "+", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"FMii", "*", "mxx", "*", 
           RowBox[{"Hxx", "[", "i", "]"}]}], " ", "+", " ", 
          RowBox[{"FMii", "*", "myy", "*", 
           RowBox[{"Hyy", "[", "i", "]"}]}], " ", "+", " ", 
          RowBox[{"FMij", "*", "mxy", "*", 
           RowBox[{"Hxy", "[", "i", "]"}]}]}], ")"}]}], ")"}]}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"feq", "[", "i_", "]"}], " ", ":=", " ", 
     RowBox[{"\[Rho]", "*", 
      RowBox[{"w", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "*", 
      RowBox[{"(", 
       RowBox[{"1", " ", "+", " ", 
        RowBox[{"3", "*", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ux", "*", 
            RowBox[{"cx", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], " ", "+", " ", 
           RowBox[{"uy", "*", 
            RowBox[{"cy", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], ")"}]}], " ", "+", " ", 
        RowBox[{"9", "*", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"ux", "*", "ux", "*", 
             RowBox[{"Hxx", "[", "i", "]"}]}], " ", "+", " ", 
            RowBox[{"uy", "*", "uy", "*", 
             RowBox[{"Hyy", "[", "i", "]"}]}], " ", "+", " ", 
            RowBox[{"2", "*", "ux", "*", "uy", "*", 
             RowBox[{"Hxy", "[", "i", "]"}]}]}], ")"}], "/", "2"}]}]}], 
       ")"}]}]}], ";"}], "\n", 
   RowBox[{"f", "[", "1", "]"}], "\n", 
   RowBox[{"f", "[", "2", "]"}], "\n", 
   RowBox[{"f", "[", "3", "]"}], "\n", 
   RowBox[{"f", "[", "4", "]"}], "\n", 
   RowBox[{"f", "[", "5", "]"}], "\n", 
   RowBox[{"f", "[", "6", "]"}], "\n", 
   RowBox[{"f", "[", "7", "]"}], "\n", 
   RowBox[{"f", "[", "8", "]"}], "\n", 
   RowBox[{"f", "[", "9", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9622052258229313`*^9, 3.9622052889386*^9}, {
  3.962205362999874*^9, 3.9622053952680387`*^9}, {3.962205508099929*^9, 
  3.9622055083813877`*^9}, {3.962205540769738*^9, 3.9622055876371727`*^9}, {
  3.9622056904139843`*^9, 3.962205753820161*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"c414c1bf-914f-4d18-b18d-d771e4817539"],

Cell[BoxData[
 RowBox[{
  FractionBox["4", "9"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    FractionBox[
     RowBox[{"FMii", " ", "mxx"}], "3"], "-", 
    FractionBox[
     RowBox[{"FMii", " ", "myy"}], "3"]}], ")"}], " ", "\[Rho]"}]], "Output",
 CellChangeTimes->{{3.9622052572594767`*^9, 3.962205292554002*^9}, {
   3.9622053644496593`*^9, 3.962205395871174*^9}, 3.962205673306666*^9, 
   3.962205755515458*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"eae2cdf3-37bd-47ad-bf8a-5db597634353"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "9"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{"2", " ", "FMii", " ", "mxx"}], "3"], "-", 
    FractionBox[
     RowBox[{"FMii", " ", "myy"}], "3"], "+", 
    RowBox[{"FMi", " ", "ux"}]}], ")"}], " ", "\[Rho]"}]], "Output",
 CellChangeTimes->{{3.9622052572594767`*^9, 3.962205292554002*^9}, {
   3.9622053644496593`*^9, 3.962205395871174*^9}, 3.962205673306666*^9, 
   3.9622057555194607`*^9},
 CellLabel->
  "Out[126]=",ExpressionUUID->"c2c9c547-f9be-48ec-9281-684ed1e3e276"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "9"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    FractionBox[
     RowBox[{"FMii", " ", "mxx"}], "3"], "+", 
    FractionBox[
     RowBox[{"2", " ", "FMii", " ", "myy"}], "3"], "+", 
    RowBox[{"FMi", " ", "uy"}]}], ")"}], " ", "\[Rho]"}]], "Output",
 CellChangeTimes->{{3.9622052572594767`*^9, 3.962205292554002*^9}, {
   3.9622053644496593`*^9, 3.962205395871174*^9}, 3.962205673306666*^9, 
   3.9622057555217543`*^9},
 CellLabel->
  "Out[127]=",ExpressionUUID->"79ff4ca0-4a51-4b32-90fd-45ea1ab9415c"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "9"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{"2", " ", "FMii", " ", "mxx"}], "3"], "-", 
    FractionBox[
     RowBox[{"FMii", " ", "myy"}], "3"], "-", 
    RowBox[{"FMi", " ", "ux"}]}], ")"}], " ", "\[Rho]"}]], "Output",
 CellChangeTimes->{{3.9622052572594767`*^9, 3.962205292554002*^9}, {
   3.9622053644496593`*^9, 3.962205395871174*^9}, 3.962205673306666*^9, 
   3.9622057555232077`*^9},
 CellLabel->
  "Out[128]=",ExpressionUUID->"fff4e6d1-7f77-467a-bd41-7c0ca85067df"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "9"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "-", 
    FractionBox[
     RowBox[{"FMii", " ", "mxx"}], "3"], "+", 
    FractionBox[
     RowBox[{"2", " ", "FMii", " ", "myy"}], "3"], "-", 
    RowBox[{"FMi", " ", "uy"}]}], ")"}], " ", "\[Rho]"}]], "Output",
 CellChangeTimes->{{3.9622052572594767`*^9, 3.962205292554002*^9}, {
   3.9622053644496593`*^9, 3.962205395871174*^9}, 3.962205673306666*^9, 
   3.96220575552444*^9},
 CellLabel->
  "Out[129]=",ExpressionUUID->"f81ddc83-9947-4e79-a3c2-dc49ae8584b5"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "36"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{"2", " ", "FMii", " ", "mxx"}], "3"], "+", 
    RowBox[{"FMij", " ", "mxy"}], "+", 
    FractionBox[
     RowBox[{"2", " ", "FMii", " ", "myy"}], "3"], "+", 
    RowBox[{"FMi", " ", 
     RowBox[{"(", 
      RowBox[{"ux", "+", "uy"}], ")"}]}]}], ")"}], " ", "\[Rho]"}]], "Output",\

 CellChangeTimes->{{3.9622052572594767`*^9, 3.962205292554002*^9}, {
   3.9622053644496593`*^9, 3.962205395871174*^9}, 3.962205673306666*^9, 
   3.9622057555257187`*^9},
 CellLabel->
  "Out[130]=",ExpressionUUID->"a35f29a7-1c17-4626-9fbd-2d251a8ebf48"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "36"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{"2", " ", "FMii", " ", "mxx"}], "3"], "-", 
    RowBox[{"FMij", " ", "mxy"}], "+", 
    FractionBox[
     RowBox[{"2", " ", "FMii", " ", "myy"}], "3"], "+", 
    RowBox[{"FMi", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "ux"}], "+", "uy"}], ")"}]}]}], ")"}], " ", 
  "\[Rho]"}]], "Output",
 CellChangeTimes->{{3.9622052572594767`*^9, 3.962205292554002*^9}, {
   3.9622053644496593`*^9, 3.962205395871174*^9}, 3.962205673306666*^9, 
   3.96220575552704*^9},
 CellLabel->
  "Out[131]=",ExpressionUUID->"b0567d83-fcad-44c3-bcfc-f3cf0cd95fbc"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "36"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{"2", " ", "FMii", " ", "mxx"}], "3"], "+", 
    RowBox[{"FMij", " ", "mxy"}], "+", 
    FractionBox[
     RowBox[{"2", " ", "FMii", " ", "myy"}], "3"], "+", 
    RowBox[{"FMi", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "ux"}], "-", "uy"}], ")"}]}]}], ")"}], " ", 
  "\[Rho]"}]], "Output",
 CellChangeTimes->{{3.9622052572594767`*^9, 3.962205292554002*^9}, {
   3.9622053644496593`*^9, 3.962205395871174*^9}, 3.962205673306666*^9, 
   3.962205755528295*^9},
 CellLabel->
  "Out[132]=",ExpressionUUID->"2d4d4de0-4caa-42c6-b7f0-1958861b96f1"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "36"], " ", 
  RowBox[{"(", 
   RowBox[{"1", "+", 
    FractionBox[
     RowBox[{"2", " ", "FMii", " ", "mxx"}], "3"], "-", 
    RowBox[{"FMij", " ", "mxy"}], "+", 
    FractionBox[
     RowBox[{"2", " ", "FMii", " ", "myy"}], "3"], "+", 
    RowBox[{"FMi", " ", 
     RowBox[{"(", 
      RowBox[{"ux", "-", "uy"}], ")"}]}]}], ")"}], " ", "\[Rho]"}]], "Output",\

 CellChangeTimes->{{3.9622052572594767`*^9, 3.962205292554002*^9}, {
   3.9622053644496593`*^9, 3.962205395871174*^9}, 3.962205673306666*^9, 
   3.962205755529491*^9},
 CellLabel->
  "Out[133]=",ExpressionUUID->"1d724087-0979-49cc-bcd3-8f091fc72454"]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{
  3.96220528070975*^9},ExpressionUUID->"f4233311-3c6e-4a22-b922-acc358cb16eb"]
},
WindowToolbars->"EditBar",
WindowSize->{1854, 1003},
WindowMargins->{{Automatic, 0}, {0, Automatic}},
Magnification:>1.3 Inherited,
FrontEndVersion->"12.0 for Linux x86 (64-bit) (April 8, 2019)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 5828, 157, 747, "Input",ExpressionUUID->"c414c1bf-914f-4d18-b18d-d771e4817539"],
Cell[6411, 181, 502, 13, 89, "Output",ExpressionUUID->"eae2cdf3-37bd-47ad-bf8a-5db597634353"],
Cell[6916, 196, 552, 14, 122, "Output",ExpressionUUID->"c2c9c547-f9be-48ec-9281-684ed1e3e276"],
Cell[7471, 212, 552, 14, 89, "Output",ExpressionUUID->"79ff4ca0-4a51-4b32-90fd-45ea1ab9415c"],
Cell[8026, 228, 552, 14, 89, "Output",ExpressionUUID->"fff4e6d1-7f77-467a-bd41-7c0ca85067df"],
Cell[8581, 244, 549, 14, 89, "Output",ExpressionUUID->"f81ddc83-9947-4e79-a3c2-dc49ae8584b5"],
Cell[9133, 260, 659, 18, 89, "Output",ExpressionUUID->"a35f29a7-1c17-4626-9fbd-2d251a8ebf48"],
Cell[9795, 280, 680, 19, 89, "Output",ExpressionUUID->"b0567d83-fcad-44c3-bcfc-f3cf0cd95fbc"],
Cell[10478, 301, 681, 19, 89, "Output",ExpressionUUID->"2d4d4de0-4caa-42c6-b7f0-1958861b96f1"],
Cell[11162, 322, 657, 18, 89, "Output",ExpressionUUID->"1d724087-0979-49cc-bcd3-8f091fc72454"]
}, Open  ]],
Cell[11834, 343, 144, 2, 75, "Input",ExpressionUUID->"f4233311-3c6e-4a22-b922-acc358cb16eb"]
}
]
*)

